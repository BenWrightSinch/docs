---
title: "Receiving Updates & Callbacks"
excerpt: ""
---
Message status updates, events and messages from the RCS REST API and user agents, are delivered to the API client using webhook callbacks.

All types of callbacks are sent to the same HTTP(S) endpoint registered in the RCS REST API. See [Registering Webhook URI](#section-registering-webhook-uri) for details on how to register a webhook URI.

Callbacks are categorized as:

 * [Status Reports](#section-status-reports), sent every time the status of a sent message changes
 * [User Agent Events](#section-user-agent-events), sent for events generated by the user agent, e.g., composing notifications
 * [User Agent Messages](#section-user-agent-messages), sent whenever the user agent manually sends a message (text/image/location/etc.) or interacts with sent suggestion chips.

A callback is a HTTP POST request with a notification made by the RCS REST API to a URI of your choosing. The RCS REST API expects the receiving server to respond with a response code within the 2xx Success range. If no successful response is received then the RCS REST API will either schedule a retry if the error is expected to be temporary or discard the callback if the error seems to be permanent.

### Registering Webhook URI

Please contact Sinch to update the webhook URL.

### Callback Request

Callbacks are sent as a JSON encoded HTTP POST requests to the agent-specific webhook URI (See [Registering Webhook URI](#section-registering-webhook-uri)):

`POST {agent_callback_uri}`

### Callback Payload

The callback payload format is as such:
[block:code]
{
  "codes": [
    {
      "code": "{\n  \"type\": enum(\n    \"status_report_rcs\",\n    \"user_agent_event_rcs\",\n    \"user_agent_message_rcs\"\n  ),\n  ... // type specific fields\n}",
      "language": "json",
      "name": "JSON Representation"
    }
  ]
}
[/block]
#### Fields

Depending on the type of callback the payload will be one of (as indicated by `type` field):

 * [StatusReport](#section-status-reports)
 * [UserAgentEvent](#section-user-agent-events)
 * [UserAgentMessage](#section-user-agent-messages)

#### Examples

##### Successfully delivery RCS message
[block:code]
{
  "codes": [
    {
      "code": "{\n  \"type\": \"status_report_rcs\",\n  \"message_id\": \"bc6776ee-7bde-4d6e-9c1e-102e87f92520\",\n  \"at\": \"2017-10-31T13:06:30Z\",\n  \"status_report\": {\n    \"type\": \"delivered\"\n  }\n}",
      "language": "json",
      "name": ""
    }
  ]
}
[/block]
##### Message dispatched as SMS fallback

An SMS fallback was delivered since the RCS message was not delivered before it expired.
[block:code]
{
  "codes": [
    {
      "code": "{\n  \"type\": \"status_report_rcs\",\n  \"message_id\": \"9cd91120-5e54-4d42-af22-1a042502ad97\",\n  \"at\": \"2017-10-31T13:06:30Z\",\n  \"status_report\": {\n    \"type\": \"fallback_dispatched\",\n    \"external_ref\": \"23esaaf9912s\",\n    \"revoked\": true,\n    \"reason\": {\n      \"type\": \"expired\"\n    }\n  }\n}",
      "language": "json",
      "name": ""
    }
  ]
}
[/block]
##### User agent taps a suggested reply chip
[block:code]
{
  "codes": [
    {
      "code": "{\n  \"type\": \"user_agent_message_rcs\",\n  \"message_id\": \"9lkj32asd712jkasdjkasdkhsadasd\",\n  \"from\": \"4655123456\",\n  \"message\": {\n    \"type\": \"suggestion_response\",\n    \"postback_data\": \"ef425f90-a27b-4956-9ba0-37cdd2d6e160_YES_CHIP\",\n    \"text\": \"Yes\"\n  }\n}",
      "language": "json",
      "name": ""
    }
  ]
}
[/block]
### Status reports

Message status reports are sent whenever a message performs a state transition in the diagram below:
[block:image]
{
  "images": [
    {
      "image": [
        "https://files.readme.io/7a614d0-status_states.png",
        "status_states.png",
        619,
        811,
        "#cfcfc7"
      ],
      "caption": "Message state transitions and flow diagram. Rectangles represent states communicated using `StatusReport` callback payloads. The logic in the flow diagram is controlled by various options passed to the `FallbackInfo` when sending a message, combined with events such as message expiry (see `ExpireInfo`), supplier errors, etc.",
      "sizing": "full"
    }
  ]
}
[/block]
#### Status descriptions

| Status                         | Description                                                                                              |
| ------------------------------ | -------------------------------------------------------------------------------------------------------- |
| queued                         | Message has entered the RCS REST API system. This is the initial state for a message.                    |
| capability\_lookup\_dispatched | Message is awaiting capability lookup request dispatched with the RCS supplier.                          |
| dispatched                     | Message was dispatched to the selected RCS supplier / operator platform.                                 |
| fallback\_dispatched           | Message was not sent as RCS message, and a fallback SMS has been dispatched. See [SMS Fallback](doc:sms-fallback). |
| aborted                        | Message expired or was revoked, and no fallback SMS was requested.                                       |
| failed                         | Message failed to be dispatched as RCS, and fallback SMS also failed.                                    |
| delivered                      | Message was successfully delivered to the handset.                                                       |
| displayed                      | Message was displayed on the handset.                                                                    |

#### JSON Models

Detailed description of all available status report payloads

##### StatusReport

JSON Representation
[block:code]
{
  "codes": [
    {
      "code": "{\n  \"type\": \"status_report_rcs\",\n  \"message_id\": string,\n  \"at\": timestamp,\n  \"status_report\": {\n    \"type\": enum(\n      \"queued\",\n      \"capability_lookup_dispatched\",\n      \"dispatched\",\n      \"fallback_dispatched\",\n      \"aborted\",\n      \"failed\",\n      \"delivered\",\n      \"displayed\"\n    ),\n    ... // type specific fields\n  }\n}",
      "language": "json",
      "name": null
    }
  ]
}
[/block]

[block:html]
{
  "html": "<div class=\"marked-table\">\n<table>\n<thead>\n<tr class=\"header\">\n<th>Field</th>\n<th>Type</th>\n<th>Description</th>\n<th>Default</th>\n<th>Constraints</th>\n<th>Required</th>\n</tr>\n</thead>\n<tbody>\n<tr class=\"odd\">\n<td>type</td>\n<td>string</td>\n<td>Static string 'status_report_rcs'</td>\n<td>N/A</td>\n<td>N/A</td>\n<td>Yes</td>\n</tr>\n<tr class=\"even\">\n<td>message_id</td>\n<td>string</td>\n<td>Message id for which this status report is relevant</td>\n<td>No</td>\n<td>^[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$</td>\n<td>Yes</td>\n</tr>\n<tr class=\"odd\">\n<td>at</td>\n<td>string</td>\n<td>Timestamp of then the status report was created in the Sinch service</td>\n<td>No</td>\n<td>A timestamp in RFC3339 UTC \"Zulu\" format</td>\n<td>Yes</td>\n</tr>\n<tr class=\"even\">\n<td>status_report</td>\n<td><dl>\n<dt>oneOf:</dt>\n<dd><ul>\n<li>object(<code class=\"interpreted-text\" data-role=\"ref\">StatusReportQueued</code>)</li>\n<li>object(<code class=\"interpreted-text\" data-role=\"ref\">StatusReportCapabilityLookupDispatched</code>)</li>\n<li>object(<code class=\"interpreted-text\" data-role=\"ref\">StatusReportDispatched</code>)</li>\n<li>object(<code class=\"interpreted-text\" data-role=\"ref\">StatusReportFallbackDispatched</code>)</li>\n<li>object(<code class=\"interpreted-text\" data-role=\"ref\">StatusReportAborted</code>)</li>\n<li>object(<code class=\"interpreted-text\" data-role=\"ref\">StatusReportFailed</code>)</li>\n<li>object(<code class=\"interpreted-text\" data-role=\"ref\">StatusReportDelivered</code>)</li>\n<li>object(<code class=\"interpreted-text\" data-role=\"ref\">StatusReportDisplayed</code>)</li>\n</ul>\n</dd>\n</dl></td>\n<td>Object describing the status report. The type of report is identified by the type property.</td>\n<td>No</td>\n<td>N/A</td>\n<td>Yes</td>\n</tr>\n</tbody>\n</table>\n</div>\n\n<style></style>"
}
[/block]
##### StatusReportQueued
[block:code]
{
  "codes": [
    {
      "code": "{\n  \"type\": \"queued\"\n}",
      "language": "json"
    }
  ]
}
[/block]
###### Fields

| Field | Type   | Description            | Default | Constraints | Required |
| ----- | ------ | ---------------------- | ------- | ----------- | -------- |
| type  | string | Static string 'queued' | N/A     | N/A         | Yes      |

##### StatusReportCapabilityLookupDispatched
[block:code]
{
  "codes": [
    {
      "code": "{\n  \"type\": \"capability_lookup_dispatched\"\n}",
      "language": "json"
    }
  ]
}
[/block]
###### Fields

| Field | Type   | Description                                    | Default | Constraints | Required |
| ----- | ------ | ---------------------------------------------- | ------- | ----------- | -------- |
| type  | string | Static string 'capability\_lookup\_dispatched' | N/A     | N/A         | Yes      |

##### StatusReportDispatched
[block:code]
{
  "codes": [
    {
      "code": "{\n  \"type\": \"dispatched\"\n}",
      "language": "json"
    }
  ]
}
[/block]
###### Fields

| Field | Type   | Description                | Default | Constraints | Required |
| ----- | ------ | -------------------------- | ------- | ----------- | -------- |
| type  | string | Static string 'dispatched' | N/A     | N/A         | Yes      |

##### StatusReportFallbackDispatched
[block:code]
{
  "codes": [
    {
      "code": "{\n  \"type\": \"fallback_dispatched\",\n  \"external_ref\": string,\n  \"revoked\": boolean,\n  \"reason\": {\n    \"type\": enum(\n      \"rcs_unavailable\",\n      \"capability_unsupported\",\n      \"expired\",\n      \"agent_error\",\n    ),\n    ... // type specific fields\n  }\n}",
      "language": "json"
    }
  ]
}
[/block]
###### Fields
[block:html]
{
  "html": "<div class=\"marked-table\">\n<table>\n<thead>\n<tr class=\"header\">\n<th>Field</th>\n<th>Type</th>\n<th>Description</th>\n<th>Default</th>\n<th>Constraints</th>\n<th>Required</th>\n</tr>\n</thead>\n<tbody>\n<tr class=\"odd\">\n<td>type</td>\n<td>string</td>\n<td>Static string 'fallback_dispatched'</td>\n<td>N/A</td>\n<td>N/A</td>\n<td>Yes</td>\n</tr>\n<tr class=\"even\">\n<td>external_ref</td>\n<td>string</td>\n<td>SMS HTTP REST API batch id after fallback</td>\n<td>No</td>\n<td>N/A</td>\n<td>Yes</td>\n</tr>\n<tr class=\"odd\">\n<td>revoked</td>\n<td>boolean</td>\n<td>Has the RCS message been revoked?</td>\n<td>No</td>\n<td>N/A</td>\n<td>Yes</td>\n</tr>\n<tr class=\"even\">\n<td>reason</td>\n<td><dl>\n<dt>oneOf:</dt>\n<dd><ul>\n<li>object(<code class=\"interpreted-text\" data-role=\"ref\">FallbackReasonRcsUnavailable</code>)</li>\n<li>object(<code class=\"interpreted-text\" data-role=\"ref\">FallbackReasonCapabilityUnsupported</code>)</li>\n<li>object(<code class=\"interpreted-text\" data-role=\"ref\">FallbackReasonExpired</code>)</li>\n<li>object(<code class=\"interpreted-text\" data-role=\"ref\">FallbackReasonAgentError</code>)</li>\n</ul>\n</dd>\n</dl></td>\n<td>The reason why the fallback occurred, always based on one of the provided fallback conditions</td>\n<td>No</td>\n<td>N/A</td>\n<td>Yes</td>\n</tr>\n</tbody>\n</table>\n</div>\n\n<style></style>"
}
[/block]
##### FallbackReasonRcsUnavailable
[block:code]
{
  "codes": [
    {
      "code": "{\n  \"type\": \"rcs_unavailable\"\n}",
      "language": "json"
    }
  ]
}
[/block]
###### Fields

| Field | Type   | Description                      | Default | Constraints | Required |
| ----- | ------ | -------------------------------- | ------- | ----------- | -------- |
| type  | string | Static string 'rcs\_unavailable' | N/A     | N/A         | Yes      |

##### FallbackReasonCapabilityUnsupported
[block:code]
{
  "codes": [
    {
      "code": "{\n  \"type\": \"capability_unsupported\"\n}",
      "language": "json"
    }
  ]
}
[/block]
###### Fields

| Field | Type   | Description                             | Default | Constraints | Required |
| ----- | ------ | --------------------------------------- | ------- | ----------- | -------- |
| type  | string | Static string 'capability\_unsupported' | N/A     | N/A         | Yes      |

##### FallbackReasonExpired
[block:code]
{
  "codes": [
    {
      "code": "{\n  \"type\": \"expired\"\n}",
      "language": "json"
    }
  ]
}
[/block]
###### Fields

| Field | Type   | Description             | Default | Constraints | Required |
| ----- | ------ | ----------------------- | ------- | ----------- | -------- |
| type  | string | Static string 'expired' | N/A     | N/A         | Yes      |

##### FallbackReasonAgentError
[block:code]
{
  "codes": [
    {
      "code": "{\n  \"type\": \"agent_error\",\n  \"code\": integer,\n  \"reason\": string\n}",
      "language": "json",
      "name": null
    }
  ]
}
[/block]
###### Fields

| Field  | Type    | Description                                    | Default | Constraints | Required |
| ------ | ------- | ---------------------------------------------- | ------- | ----------- | -------- |
| type   | string  | Static string 'agent\_error'                   | N/A     | N/A         | Yes      |
| code   | integer | Error code of agent error causing the fallback | N/A     | N/A         | Yes      |
| reason | string  | Descriptive message of why the message failed  | N/A     | N/A         | Yes      |

##### StatusReportAborted
[block:code]
{
  "codes": [
    {
      "code": "{\n  \"type\": \"aborted\",\n  \"revoked\": boolean,\n  \"expired\": boolean\n}",
      "language": "json"
    }
  ]
}
[/block]
###### Fields

| Field   | Type    | Description                       | Default | Constraints | Required |
| ------- | ------- | --------------------------------- | ------- | ----------- | -------- |
| type    | string  | Static string 'aborted'           | N/A     | N/A         | Yes      |
| revoked | boolean | Has the RCS message been revoked? | No      | N/A         | Yes      |
| expired | boolean | Has the RCS message expired?      | No      | N/A         | Yes      |

##### StatusReportFailed
[block:code]
{
  "codes": [
    {
      "code": "{\n  \"type\": \"failed\",\n  \"revoked\": boolean,\n  \"expired\": boolean,\n  \"code\": integer,\n  \"reason\": string\n}",
      "language": "json"
    }
  ]
}
[/block]
###### Fields

| Field   | Type    | Description                                    | Default | Constraints | Required |
| ------- | ------- | ---------------------------------------------- | ------- | ----------- | -------- |
| type    | string  | Static string 'failed'                         | N/A     | N/A         | Yes      |
| revoked | boolean | Has the RCS message been revoked?              | No      | N/A         | Yes      |
| expired | boolean | Has the RCS message been expired?              | No      | N/A         | Yes      |
| code    | integer | Error code of agent error causing the fallback | No      | N/A         | Yes      |
| reason  | string  | Descriptive message of why the message failed  | No      | N/A         | Yes      |

##### StatusReportDelivered
[block:code]
{
  "codes": [
    {
      "code": "{\n  \"type\": \"delivered\"\n}",
      "language": "json"
    }
  ]
}
[/block]
###### Fields

| Field | Type   | Description               | Default | Constraints | Required |
| ----- | ------ | ------------------------- | ------- | ----------- | -------- |
| type  | string | Static string 'delivered' | N/A     | N/A         | Yes      |

##### StatusReportDisplayed
[block:code]
{
  "codes": [
    {
      "code": "{\n  \"type\": \"displayed\"\n}",
      "language": "json"
    }
  ]
}
[/block]
###### Fields

| Field | Type   | Description               | Default | Constraints | Required |
| ----- | ------ | ------------------------- | ------- | ----------- | -------- |
| type  | string | Static string 'displayed' | N/A     | N/A         | Yes      |

### User Agent Events

Detailed descriptions of all available user agent event payloads.

#### JSON Models

##### UserAgentEvent
[block:code]
{
  "codes": [
    {
      "code": "{\n  \"type\": \"user_agent_event_rcs\",\n  \"from\": MSIDSN,\n  \"event\": {\n    \"type\": enum(\"composing\"),\n    ... // type specific fields\n  }\n}",
      "language": "json"
    }
  ]
}
[/block]
###### Fields
[block:html]
{
  "html": "<div class=\"marked-table\">\n<table>\n<thead>\n<tr class=\"header\">\n<th>Field</th>\n<th>Type</th>\n<th>Description</th>\n<th>Default</th>\n<th>Constraints</th>\n<th>Required</th>\n</tr>\n</thead>\n<tbody>\n<tr class=\"odd\">\n<td>type</td>\n<td>string</td>\n<td>Static string 'user_agent_event_rcs'</td>\n<td>N/A</td>\n<td>N/A</td>\n<td>Yes</td>\n</tr>\n<tr class=\"even\">\n<td>from</td>\n<td>string</td>\n<td>MSISDN of the device that sent the event</td>\n<td>No</td>\n<td>No</td>\n<td>Yes</td>\n</tr>\n<tr class=\"odd\">\n<td>event</td>\n<td><dl>\n<dt>oneOf:</dt>\n<dd><ul>\n<li>object(<code class=\"interpreted-text\" data-role=\"ref\">UserAgentEventComposing</code>)</li>\n</ul>\n</dd>\n</dl></td>\n<td>Object describing the event</td>\n<td>No</td>\n<td>N/A</td>\n<td>Yes</td>\n</tr>\n</tbody>\n</table>\n</div>\n\n<style></style>"
}
[/block]
##### UserAgentEventComposing
[block:code]
{
  "codes": [
    {
      "code": "{\n  \"type\": \"composing\"\n}",
      "language": "json"
    }
  ]
}
[/block]
###### Fields

| Field | Type   | Description                                                                     | Default | Constraints | Required |
| ----- | ------ | ------------------------------------------------------------------------------- | ------- | ----------- | -------- |
| type  | string | Static string 'composing'. This type notifies the agent that the user is typing | N/A     | N/A         | Yes      |

### User Agent Messages

Detailed descriptions of all available user agent message payloads

#### JSON Models

##### UserAgentMessage
[block:code]
{
  "codes": [
    {
      "code": "{\n  \"type\": \"user_agent_message_rcs\",\n  \"message_id\": string,\n  \"from\": MSISDN,\n  \"message\": {\n    \"type\": enum(\n      \"text\",\n      \"file\",\n      \"suggestion_response\",\n      \"location\"\n    ),\n    ... // type specific fields\n  }\n}",
      "language": "json"
    }
  ]
}
[/block]
###### Fields
[block:html]
{
  "html": "<div class=\"marked-table\">\n<table>\n<thead>\n<tr class=\"header\">\n<th>Field</th>\n<th>Type</th>\n<th>Description</th>\n<th>Default</th>\n<th>Constraints</th>\n<th>Required</th>\n</tr>\n</thead>\n<tbody>\n<tr class=\"odd\">\n<td>type</td>\n<td>string</td>\n<td>Static string 'user_agent_message_rcs'</td>\n<td>N/A</td>\n<td>N/A</td>\n<td>Yes</td>\n</tr>\n<tr class=\"even\">\n<td>message_id</td>\n<td>string</td>\n<td>Unique message id for this user message</td>\n<td>No</td>\n<td>No</td>\n<td>Yes</td>\n</tr>\n<tr class=\"odd\">\n<td>from</td>\n<td>string</td>\n<td>MSISDN of the device that sent the message</td>\n<td>No</td>\n<td>No</td>\n<td>Yes</td>\n</tr>\n<tr class=\"even\">\n<td>message</td>\n<td><dl>\n<dt>oneOf:</dt>\n<dd><ul>\n<li>object(<code class=\"interpreted-text\" data-role=\"ref\">TextMessage</code>)</li>\n<li>object(<code class=\"interpreted-text\" data-role=\"ref\">FileMessage</code>)</li>\n<li>object(<code class=\"interpreted-text\" data-role=\"ref\">SuggestionResponse</code>)</li>\n<li>object(<code class=\"interpreted-text\" data-role=\"ref\">LocationMessage</code>)</li>\n</ul>\n</dd>\n</dl></td>\n<td>The message content</td>\n<td>No</td>\n<td>N/A</td>\n<td>Yes</td>\n</tr>\n</tbody>\n</table>\n</div>\n\n<style></style>"
}
[/block]
##### SuggestionResponse
[block:code]
{
  "codes": [
    {
      "code": "{\n  \"type\": \"suggestion_response\",\n  \"postback_data\": string,\n  \"text\": string\n}",
      "language": "json"
    }
  ]
}
[/block]
###### Fields

| Field          | Type   | Description                                                                                      | Default | Constraints | Required |
| -------------- | ------ | ------------------------------------------------------------------------------------------------ | ------- | ----------- | -------- |
| type           | string | Static string 'suggestion\_response'                                                             | N/A     | N/A         | Yes      |
| postback\_data | string | The postback data that was supplied in the object(`SuggestedReply`) or object(`SuggestedAction`) | No      | No          | No       |
| text           | string | The text that was supplied in the object(`SuggestedReply`) or object(`SuggestedAction`)          | No      | No          | No       |

At least one of `postback_data` and `text` will be set.

##### LocationMessage
[block:code]
{
  "codes": [
    {
      "code": "{\n  \"type\": \"location\",\n  \"latitude\": number,\n  \"longitude\": number\n}",
      "language": "json"
    }
  ]
}
[/block]
###### Fields

| Field     | Type   | Description                | Default | Constraints                  | Required |
| --------- | ------ | -------------------------- | ------- | ---------------------------- | -------- |
| type      | string | Static string 'location'   | N/A     | N/A                          | Yes      |
| latitude  | number | Latitude of user location  | No      | MinValue: -90 MaxValue: 90   | Yes      |
| longitude | number | Longitude of user location | No      | MinValue: -180 MaxValue: 180 | Yes      |